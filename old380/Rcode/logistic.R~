####################################
## Read in Titanic data example
## (See R-Bloggers) https://www.r-bloggers.com/how-to-perform-a-logistic-regression-in-r/
####################################

training.data.raw = read.csv("http://sites.stat.psu.edu/~mharan/380/data/TitanicTrain.csv",header=T,na.strings=c(""))
dataTitanic = subset(training.data.raw,select=c(2,3,5,6,7,8,10,12))
dataTitanic$Age[is.na(dataTitanic$Age)] = mean(dataTitanic$Age,na.rm=T)

dataTitanic = dataTitanic[!is.na(dataTitanic$Embarked),]
rownames(dataTitanic) = NULL
train = dataTitanic[1:800,]
test = dataTitanic[801:889,]

modelFit = glm(Survived ~.,family=binomial(link='logit'),data=train)
summary(modelFit)

## By setting the parameter type='response', R will output probabilities
## in the form of P(y=1|X). Our decision boundary will be 0.5. If
## P(y=1|X) > 0.5 then y = 1 otherwise y=0.

fitted.results = predict(modelFit,newdata=subset(test,select=c(2,3,4,5,6,7,8)),type='response')
fitted.results = ifelse(fitted.results > 0.5,1,0)

misClasificError = mean(fitted.results != test$Survived)
print(paste('Accuracy',1-misClasificError))
